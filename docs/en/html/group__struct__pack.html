<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="generator" content="Doxygen 1.9.6"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!-- BEGIN opengraph metadata -->
    <meta property="og:title" content="Doxygen Awesome"/>
    <meta property="og:image"
          content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"/>
    <meta property="og:description"
          content="Custom CSS theme for doxygen html-documentation with lots of customization parameters."/>
    <meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/"/>
    <!-- END opengraph metadata -->
    <!-- BEGIN twitter metadata -->
    <meta name="twitter:image:src"
          content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452"/>
    <meta name="twitter:title" content="Doxygen Awesome"/>
    <meta name="twitter:description"
          content="Custom CSS theme for doxygen html-documentation with lots of customization parameters."/>
    <!-- END twitter metadata -->
    <title>yaLanTingLibs: struct_pack</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="toggle-alternative-theme.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeParagraphLink.init()
        DoxygenAwesomeInteractiveToc.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/alibaba/yalantinglibs" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40"
         style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
<style>.github-corner:hover .octo-arm {
    animation: octocat-wave 560ms ease-in-out
}
@keyframes octocat-wave {
    0%, 100% {
        transform: rotate(0)
    }
    20%, 60% {
        transform: rotate(-25deg)
    }
    40%, 80% {
        transform: rotate(10deg)
    }
}
@media (max-width: 500px) {
    .github-corner:hover .octo-arm {
        animation: none
    }
    .github-corner .octo-arm {
        animation: octocat-wave 560ms ease-in-out
    }
}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
            <tbody>
            <tr style="height: 56px;">
                <td id="projectalign" style="padding-left: 0.5em;">
                    <div id="projectname">yaLanTingLibs
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__struct__pack.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">struct_pack</div></div>
</div><!--header-->
<div class="contents">

<p>yaLanTingLibs Serialization Library  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstruct__pack_1_1compatible.html">struct_pack::compatible&lt; T, version &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">similar to std::optional&lt;T&gt;. However, its semantics are forward compatible field.  <a href="structstruct__pack_1_1compatible.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaffc80dce5f217a69d696cec5a7de463f"><td class="memItemLeft" align="right" valign="top">STRUCT_PACK_INLINE std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__struct__pack.html#gaffc80dce5f217a69d696cec5a7de463f">struct_pack::error_message</a> (struct_pack::errc err)</td></tr>
<tr class="separator:gaffc80dce5f217a69d696cec5a7de463f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga61a8f7e26d9d136fa45806e51ef2107b"><td class="memTemplParams" colspan="2">template&lt;typename... Args&gt; </td></tr>
<tr class="memitem:ga61a8f7e26d9d136fa45806e51ef2107b"><td class="memTemplItemLeft" align="right" valign="top">STRUCT_PACK_INLINE consteval std::uint32_t&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__struct__pack.html#ga61a8f7e26d9d136fa45806e51ef2107b">struct_pack::get_type_code</a> ()</td></tr>
<tr class="separator:ga61a8f7e26d9d136fa45806e51ef2107b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>yaLanTingLibs Serialization Library </p>
<p>Based on compile-time reflection, very easy to use, high performance serialization library, struct_pack is a header only library, it is used by coro_rpc now.</p>
<h1><a class="anchor" id="struct_pack_compiler_support"></a>
Compiler Support</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Compiler   </th><th class="markdownTableHeadNone">Version    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GCC   </td><td class="markdownTableBodyNone">10.2    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Clang   </td><td class="markdownTableBodyNone">13.0.1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Apple Clang   </td><td class="markdownTableBodyNone">13.1.16    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MSVC   </td><td class="markdownTableBodyNone">14.32   </td></tr>
</table>
<h1><a class="anchor" id="struct_pack_memory_layout"></a>
Memory Layout</h1>
<p>a simple object after serialization</p>
<div class="image">
<img src="mem_layout_of_person.png" alt=""/>
<div class="caption">
person</div></div>
    <div class="image">
<img src="mem_layout_of_vec_rect.png" alt=""/>
<div class="caption">
vec</div></div>
    <div class="image">
<img src="mem_layout_of_vec_int.png" alt=""/>
<div class="caption">
std::vector&lt;int32_t&gt;</div></div>
    <p>The struct pack has a compact data format. For fundamental types (e.g. int, float) and fixed length array, the actual length is used. For container concept (e.g string, stl container), the element size is placed first, then all elements are wrote one by one.</p>
<h2><a class="anchor" id="struct_pack_speed"></a>
How to optimize serialization or</h2>
<p>deserialization</p>
<ol type="1">
<li>using fixed-length string as far as possible</li>
<li>encapsulating memory contiguous fields into a single object</li>
<li>using memory contiguous container (e.g. std::vector)</li>
</ol>
<h2><a class="anchor" id="struct_pack_binary"></a>
How to optimize serialization binary size</h2>
<p>For container and std::string, the field of element size can be compressed. You can use <code>add_definitions</code> on CMake to get the optimization. </p><div class="fragment"><div class="line"><span class="preprocessor"># use 1 byte to represent the element size, require size &lt; 256</span></div>
<div class="line">add_definitions(-DSTRUCT_PACK_USE_INT8_SIZE)</div>
<div class="line"><span class="preprocessor"># use 2 bytes to represent the element size, require size &lt; 65536</span></div>
<div class="line">add_definitions(-DSTRUCT_PACK_USE_INT16_SIZE)</div>
</div><!-- fragment --><h2><a class="anchor" id="struct_pack_limitation"></a>
Limitation</h2>
<ol type="1">
<li>the element size must less than UINT32_MAX.</li>
<li>no pointer or reference allowed in object, otherwise compile-time error reported.</li>
<li>the object must be <a href="https://en.cppreference.com/w/cpp/language/aggregate_initialization">aggregate</a>, otherwise compile-time error reported. </li>
</ol>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaffc80dce5f217a69d696cec5a7de463f" name="gaffc80dce5f217a69d696cec5a7de463f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaffc80dce5f217a69d696cec5a7de463f">&#9670;&#160;</a></span>error_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STRUCT_PACK_INLINE std::string struct_pack::error_message </td>
          <td>(</td>
          <td class="paramtype">struct_pack::errc&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the error message corresponding to the error code <code>err</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">err</td><td>error code. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error message. </dd></dl>

</div>
</div>
<a id="ga61a8f7e26d9d136fa45806e51ef2107b" name="ga61a8f7e26d9d136fa45806e51ef2107b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga61a8f7e26d9d136fa45806e51ef2107b">&#9670;&#160;</a></span>get_type_code()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Args&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">STRUCT_PACK_INLINE consteval std::uint32_t struct_pack::get_type_code </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the byte size of the packing objects. TODO: add doc </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Args</td><td>the types of packing objects. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>the packing objects. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>byte size. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
